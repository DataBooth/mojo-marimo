[workspace]
name = "mojo-marimo"
version = "0.1.0"
authors = ["Michael Booth <michael@databooth.com.au>"]
channels = ["conda-forge"]
platforms = ["osx-arm64", "linux-64", "win-64"]
description = "Interactive Mojo integration for Python notebooks"

[dependencies]
python = ">=3.12,<3.15"

[pypi-dependencies]
marimo = "*"
mojo = "*"
pytest = "*"
pytest-cov = "*"
ruff = "*"
ty = "*"

[tasks]
# Setup verification
test-setup = { cmd = "python verify_setup.py", cwd = "scripts" }

# Interactive notebooks
learn = { cmd = "marimo edit interactive_learning.py", cwd = "notebooks" }
notebook-decorator = { cmd = "marimo edit pattern_decorator.py", cwd = "notebooks" }
notebook-executor = { cmd = "marimo edit pattern_executor.py", cwd = "notebooks" }

# Benchmarks
benchmark = { cmd = "marimo edit python_vs_mojo.py", cwd = "benchmarks" }
benchmark-exec = { cmd = "marimo edit execution_approaches.py", cwd = "benchmarks" }

# Command-line demos
demo-examples = { cmd = "python examples.py", cwd = "examples" }
demo-decorator = { cmd = "python -m mojo_marimo.decorator" }

# Testing
test = "pytest tests/"
test-verbose = "pytest tests/ -v"
test-coverage = "pytest tests/ --cov=src/mojo_marimo --cov-report=term-missing"

# Code quality
format = "ruff format ."
lint = "ruff check ."
lint-fix = "ruff check --fix ."
typecheck = "ty check"

# Combined quality check
check = { depends-on = ["format", "lint", "typecheck"] }

# Development
clean-mojo-cache = "rm -rf ~/.mojo_cache/binaries/*"
cache-stats = "python -c 'from mojo_marimo.executor import cache_stats; cache_stats()'"

# CI/CD
ci = { depends-on = ["check", "test"] }
